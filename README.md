# The result of the experiments

## K-Fold only use train sets and validation sets
 The MUTAG dataset was used with 10-fold cross-validation. Using the method in sklearn, random_state is fixed to 1. The highest validation accuracy is extracted from each fold as the accuracy of that fold, and finally the model's accuracy is calculated by averaging.
## Update 2023/9/13
1. Do all the experiments on MUTAG, and create tables.  :fast_forward:
2. Using faster kernel. :fast_forward: 
3. Early stop
4. Trying different attentions.
5. Positional encoding
6. Multi head attention

## MUTAG 2023/9/13 
<font color=Yellow>Bold plus italic is the highest accuracy, bold is the second highest, and italic is the third highest.</font>

## train_val_test split
### SP
| Layers/Hops | 1 | 2 | 3 | 4 | 5 |
| :-----:| :------: | :------: | :----: | :---:| :---:|
| 1 |0.8167+/-0.0334<br>4727s |0.8056+/-0.0354<br>5998s |0.7944+/-0.0324<br>7956s |0.8222+/-0.0292<br>10307s |0.8222+/-0.0270<br>12418s |
| 2 |0.8222+/-0.0270<br>4824s |0.8333+/-0.0192<br>6121s |0.7889+/-0.0322<br>8034s | 0.8086+/-0.0288<br>10338s|0.8333+/-0.0236<br>12535s |
| 3 |0.8444+/-0.0350<br>4829s |0.8056+/-0.0307<br>6157s |0.8278+/-0.0214<br>8150s |0.8000+/-0.0335<br>10602s |0.8444+/-0.0246<br>12677s |
| 4 |0.8278+/-0.0299<br>4933s |0.8167+/-0.0249<br>6299s |0.8000+/-0.0285<br>8297s |0.8000+/-0.0335<br>10610s | 0.8222+/-0.0258<br>12719s|
| 5 |0.7889+/-0.0375<br>5042s |0.8333+/-0.0283<br>6454s |0.8000+/-0.0335<br>8426s |0.8167+/-0.0249<br>10639s |0.8444+/-0.0246<br>12856s |
| 6 |0.8389+/-0.0254<br>5198s |**0.8556+/-0.0211<br>6476s** |0.8000+/-0.0285<br>8560s |0.8056+/-0.0345<br>10764s |0.8278+/-0.0214<br>12978s |


### WL_GPU
| Layers/Hops | 1 | 2 | 3 | 4 | 5 |
| :-----:| :------: | :------: | :----: | :---:| :---:|
| 1 |0.8389+/-0.0288<br>5663s |0.8278+/-0.0299<br>6275s |0.8222+/-0.0281<br>6814s |0.8444+/-0.0219<br>7117s |0.8500+/-0.0177<br>7703s |
| 2 |0.8500+/-0.0261<br>5830s|0.8333+/-0.0248<br>6200s |0.8389+/-0.0266<br>6730s |0.8333+/-0.0272<br>7297s |0.8278+/-0.0266<br>7693s |
| 3 |0.8611+/-0.0226<br>5869s |0.8333+/-0.0248<br>6524s |0.8444+/-0.0246<br>6941s |0.8444+/-0.0281<br>7522s | 0.8444+/-0.0205<br>7854s|
| 4 |**0.8667+/-0.0238<br>6003s** |0.8389+/-0.0254<br>6482s |0.8333+/-0.0314<br>6968s |0.8111+/-0.0306<br>7508s |0.8278+/-0.0288<br>8023s |
| 5 |0.8500+/-0.0273<br>6032s |0.8222+/-0.0322<br>6516s|0.8556+/-0.0196<br>7073s |0.8333+/-0.0222<br>7703s |0.8333+/-0.0208<br>8200s |
| 6 |**0.8667+/-0.0196<br>6150s** |0.8611+/-0.0180<br>6648s |0.8444+/-0.0258<br>7149s | 0.8278+/-0.0277<br>7637s|0.8333+/-0.0208<br>8277s |

### Graphlet 
sample 3 nodes graphlets
| Layers/Hops | 1 | 2 | 3 | 4 | 5 |
| :-----:| :------: | :------: | :----: | :---:| :---:|
| 1 |None | |0.8222+/-0.0270<br>12331s |0.8222+/-0.0246<br>15531s |0.8167+/-0.0294<br>18601s |
| 2 |None |0.8278+/-0.0228<br>8644s |0.8222+/-0.0292<br>12524s |0.8167+/-0.0305<br>15646s|0.8111+/-0.0326<br>18817s |
| 3 |None | |0.8389+/-0.0214<br>12589s |0.8500+/-0.0236<br>15976s |0.8056+/-0.0297<br>18679s |
| 4 |None |0.8389+/-0.0242<br>8828s |0.8278+/-0.0288<br>12620s |0.8278+/-0.0228<br>16023s |0.8333+/-0.0283<br>19165s |
| 5 |None |0.8333+/-0.0222<br>8911s |0.8111+/-0.0251<br>12567s |0.8222+/-0.0331<br>16020s |0.8389+/-0.0228<br>18577s |
| 6 |None |**0.8500+/-0.0223<br>9060s** |0.8500+/-0.0209<br>12914s |0.8222+/-0.0233<br>15893s |0.8278+/-0.0337<br>19063s |

### WLSP
| Layers/Hops | 1 | 2 | 3 | 4 | 5 |
| :-----:| :------: | :------: | :----: | :---:| :---:|
| 1 | | | | | |
| 2 | | | | | |
| 3 | | | | | |
| 4 | | | | | |
| 5 | | | | | |
| 6 | | | | | |


## PTC
### Shortest Path
### WL_GPU Parallel and precomputing
| Layers/Hops | 1 | 2 | 3 | 4 | 5 |
| :-----:| :------: | :------: | :----: | :---:| :---:|
| 1 |0.5941+/-0.0275<br>383s |0.5882+/-0.0228<br>1799s |0.5971+/-0.0208<br>3753s |0.5676+/-0.0276<br>4176s |0.5882+/-0.0300<br>3462s |
| 2 |0.5735+/-0.0187<br>447s |0.6206+/-0.0237<br>1864s |0.5912+/-0.0244<br>3805s |0.5971+/-0.0253<br>4220s |0.5882+/-0.0191<br>3518s |
| 3 |0.5834+/-0.0199<br>510s |0.6382+/-0.0220<br>1930s |0.6206+/-0.0214<br>3873s |0.5882+/-0.0212<br>4279s |0.5676+/-0.0243<br>3579s |
| 4 |0.5735+/-0.0196<br>576s |0.5941+/-0.0155<br>1988s |0.6118+/-0.0215<br>3941s |0.6029+/-0.0270<br>4356s |0.5824+/-0.0256<br>3643s |
| 5 |0.6088+/-0.0224<br>648s |0.6206+/-0.0121<br>2061s |0.5824+/-0.0242<br>4002s |0.5912+/-0.0258<br>4410s |0.5412+/-0.0349<br>3709s |
| 6 |0.5676+/-0.0250<br>704s |0.6235+/-0.0215<br>2125s |0.6147+/-0.0169<br>4071s |0.5824+/-0.0199<br>4472s |0.5647+/-0.0269<br>3766s |
### WL_GPU
| Layers/Hops | 1 | 2 | 3 | 4 | 5 |
| :-----:| :------: | :------: | :----: | :---:| :---:|
| 1 |0.6310+/-0.0303<br>4868s |0.6141+/-0.0522<br>5297s |0.6258+/-0.0495<br>5825s |0.6029+/-0.0497<br>6196s |0.6359+/-0.0626<br>6600s |
| 2 |0.6252+/-0.3289<br>4913s |**0.6422+/-0.0409<br>5369s** |***0.6474+/-0.0555<br>5791s*** |0.6252+/-0.0455<br>6175s |0.6137+/-0.0503<br>6558s |
| 3 |0.6085+/-0.0306<br>5016s |0.5977+/-0.0365<br>5546s |0.6082+/-0.0569<br>6020s |0.5866+/-0.0600<br>6412s |0.6304+/-0.0394<br>6690s |
| 4 |0.5974+/-0.0580<br>5107s |0.5863+/-0.0361<br>5643s |0.5918+/-0.0360<br>6116s |0.5971+/-0.0414<br>6402s |0.5971+/-0.0456<br>6923s |
| 5 |*0.6415+/-0.0346<br>5203s* |0.5588+/-0.0354<br>5660s|0.6075+/-0.0541<br>6154s |0.5804+/-0.0388<br>6490s |0.6026+/-0.0584<br>6990s |
| 6 |0.6248+/-0.0514<br>5342s |0.5804+/-0.0535<br>5816s |0.5526+/-0.0345<br>6274s |0.5977+/-0.0469<br>6803s |0.5748+/-0.0445<br>6986s |


## NCI1

### SP
| Layers/Hops | 1 | 2 | 3 | 4 | 5 |
| :-----:| :------: | :------: | :----: | :---:| :---:|
| 1 | | | | | |
| 2 | | | | | |
| 3 | | | | | |
| 4 | | | | | |
| 5 | | | | | |
| 6 | | | | | |
## GraphiT method test 
SP MUTAG 0.8444 +/- 0.0233 9850s

SP PTC 0.6059 +/- 0.0217 10845s

However, comparing with the GraphiT results, although our results for validation and test accuracy are not very bad, the train loss is still very high and it is difficult to reach near 0 case in GraphiT. And the validation loss curve stabilizes and does not move at the end.


